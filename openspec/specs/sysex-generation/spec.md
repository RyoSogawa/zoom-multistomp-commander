# Capability: sysex-generation

## Purpose

ZOOM MultiStomp向けMIDI SysExメッセージの生成機能。
## Requirements
### Requirement: エフェクターON/OFFメッセージ生成

システムは指定されたエフェクター番号（1〜6）に対してONまたはOFFのSysExメッセージを生成できなければならない（SHALL）。

#### Scenario: エフェクター1をONにするメッセージを生成

- Given: ユーザーがエフェクター番号1とON操作を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 00 00 01 00 00 00 00 F7` が生成される

#### Scenario: エフェクター3をOFFにするメッセージを生成

- Given: ユーザーがエフェクター番号3とOFF操作を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 02 00 00 00 00 00 00 F7` が生成される

### Requirement: エフェクター表示切り替えメッセージ生成

システムは指定されたエフェクター番号（1〜6）を表示するSysExメッセージを生成できなければならない（SHALL）。

#### Scenario: エフェクター2を表示するメッセージを生成

- Given: ユーザーがエフェクター番号2の表示操作を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 64 01 01 00 00 00 00 F7` が生成される

### Requirement: 複数操作の組み合わせ

システムは複数の操作を組み合わせて連続したSysExメッセージを生成できなければならない（SHALL）。

#### Scenario: エフェクター1をONにして表示する

- Given: ユーザーが「エフェクター1 ON」と「エフェクター1 表示」を選択している
- When: メッセージ生成が実行される
- Then: 2つのSysExメッセージが改行区切りで生成される

### Requirement: 16進数文字列フォーマット

生成されるメッセージは大文字の16進数でスペース区切りの文字列形式でなければならない（SHALL）。

#### Scenario: 出力フォーマットの確認

- Given: 任意の有効な操作が選択されている
- When: メッセージが生成される
- Then: 出力は `F0` で始まり `F7` で終わる
- And: 各バイトは2桁の大文字16進数である
- And: バイト間はスペースで区切られている

### Requirement: チューナーON/OFFメッセージ生成

システムはチューナーをONまたはOFFにするSysExメッセージを生成できなければならない（SHALL）。

#### Scenario: チューナーをONにするメッセージを生成

- Given: ユーザーがチューナーON操作を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 0B F7` が生成される

#### Scenario: チューナーをOFFにするメッセージを生成

- Given: ユーザーがチューナーOFF操作を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 0C F7` が生成される

### Requirement: パッチボリュームメッセージ生成

システムは指定された値（0〜100）でパッチボリュームを設定するSysExメッセージを生成できなければならない（SHALL）。

#### Scenario: パッチボリュームを50に設定するメッセージを生成

- Given: ユーザーがパッチボリューム操作で値50を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 64 00 32 00 00 00 00 F7` が生成される

#### Scenario: パッチボリュームを100に設定するメッセージを生成

- Given: ユーザーがパッチボリューム操作で値100を選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 64 00 64 00 00 00 00 F7` が生成される

#### Scenario: パッチボリュームの範囲外の値

- Given: ユーザーが0未満または100を超える値を入力しようとしている
- When: 入力が検証される
- Then: 値は0〜100の範囲に制限される

### Requirement: テンポ設定メッセージ生成

システムは指定されたBPM値（40〜250）でテンポを設定するSysExメッセージを生成できなければならない（SHALL）。BPM値は下位7ビットと上位ビットに分割してエンコードされる。

#### Scenario: テンポを120BPMに設定するメッセージを生成

- Given: ユーザーがテンポ操作で120BPMを選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 64 02 78 00 00 00 00 F7` が生成される
- Note: 120 = 0x78、上位ビットは0

#### Scenario: テンポを200BPMに設定するメッセージを生成

- Given: ユーザーがテンポ操作で200BPMを選択している
- When: メッセージ生成が実行される
- Then: `F0 52 00 6E 64 20 00 64 02 48 01 00 00 00 F7` が生成される
- Note: 200 = 0xC8 = 128 + 72、下位7ビット = 72 (0x48)、上位ビット = 1

#### Scenario: テンポの範囲外の値

- Given: ユーザーが40未満または250を超える値を入力しようとしている
- When: 入力が検証される
- Then: 値は40〜250の範囲に制限される

